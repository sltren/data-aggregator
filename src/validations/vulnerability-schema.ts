import Joi from "joi";

export enum SeverityEnum {
  LOW = "low",
  MEDIUM = "medium",
  HIGH = "high",
  CRITICAL = "critical",
}

const validSeverities = Object.values(SeverityEnum);

export const VulnerabilitySchema = Joi.object({
  companyId: Joi.string().required(),
  vulnerabilityId: Joi.string().required(),
  packageType: Joi.string().required(),
  packageName: Joi.string().required(),
  packageVersion: Joi.string().required(),
  description: Joi.string().required(),
  severity: Joi.string()
    .valid(...validSeverities)
    .required(),
});
