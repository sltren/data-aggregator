import { Entity, Table } from "dynamodb-toolbox";
import { config } from "../validations/envValidation";
import { DocumentClient } from "./dynamo-db-client";

export interface VulnerabilityItem {
  companyId: string;
  vulnerabilityId: string;
  packageType: string;
  packageName: string;
  packageVersion: string;
  description: string;
  severity: string;
}

const table = new Table({
  name: config.vulnerabilitiesTable,
  partitionKey: "companyId",
  sortKey: "vulnerabilityId",
  DocumentClient,
});

export const Vulnerability = new Entity({
  name: config.vulnerabilitiesTable,
  attributes: {
    companyId: { partitionKey: true, type: "string" },
    vulnerabilityId: { sortKey: true, type: "string" },
    packageType: { type: "string" },
    packageName: { type: "string" },
    packageVersion: { type: "string" },
    description: { type: "string" },
    severity: { type: "string" },
  },
  table,
});
